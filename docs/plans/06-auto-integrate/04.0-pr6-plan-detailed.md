# Claude Code Instruction: Execute PR 6 - URL Script Uses Shared Models

## Context & Goal
You are helping implement PR 6 from a 9-PR integration strategy. PRs 1-5 have been completed, establishing shared models foundation and clean TranscriptDocument-based architecture. PR 6 refactors the URL script to use shared infrastructure, eliminating code duplication.

**Objective**: Update `scripts/url_to_transcript.py` to use shared models from `youtube_to_xml.models` and `xml_builder.transcript_to_xml()`, removing duplicate code.

## Required Documents
Please analyze these documents in order:

1. **Master Plan**: `@docs/plans/06-auto-integrate/04.0-nice-pr-plan.md`
   - Provides overall integration strategy context
   - Shows where PR 6 fits in the 9-PR sequence
   - Explains what was completed in PRs 1-5

2. **PR 6 High-level Details**: See PR 6 section in the master plan for specific requirements:
   - Import shared models: `VideoMetadata`, `TranscriptLine`, `Chapter` from `youtube_to_xml.models`
   - Remove duplicate class definitions from URL script
   - Convert `VideoMetadata.video_duration` from string to int (raw seconds)
   - Use `xml_builder.transcript_to_xml()` instead of local XML functions
   - Remove local XML generation code

## Critical Changes Required ✅

**Key Refactor**: `VideoMetadata.video_duration` field type change:
- **Current**: `video_duration: str` (formatted "2h 15m 3s")
- **Target**: `video_duration: int` (raw seconds) ✅ COMPLETED
- **Reason**: Formatting now happens in xml_builder via `format_video_duration()`

## Test Driven Development Approach ✅

Before implementing each change, write focused unit tests in `tests/test_url_to_transcript.py` that verify the specific behavior being modified → run for fail → implement code → run for pass. Each test should verify one behavior with clear assertions.

**TDD Process:** ✅ COMPLETED
- Write test for desired end state (using shared models, xml_builder functions) ✅
- Run test to confirm it fails (script currently uses local implementations) ✅
- Implement the minimum code change to make test pass ✅
- Ensure all existing tests still pass ✅

## Optional: Project Index
**Recommendation**: Include `@PROJECT_INDEX.json` analysis using the index-analyzer subagent if you need to:
- Understand current URL script structure and dependencies
- Identify all duplicate model definitions to remove
- Verify XML generation functions to eliminate

For this PR 6 task, the project index is **helpful** for understanding the URL script's current structure and ensuring complete duplicate removal.

## Expected Outcome ✅ COMPLETED
After reviewing the documents, you should be ready to execute PR 6 systematically:
1. Refactor URL script to import and use shared models ✅
2. Remove ~150 lines of duplicate code ✅
3. Ensure all tests pass (script is tested via `test_end_to_end.py` and `test_exceptions_ytdlp.py`) ✅
4. Maintain full functionality while eliminating duplication ✅

**Dependencies**: This PR builds on the clean foundation established by PR 5. ✅

## Critical for PR 6 ✅ COMPLETED

Follow the Test Driven Development approach outlined above - write tests first, then implement changes to make them pass. ✅