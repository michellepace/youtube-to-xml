# Integration Task: YouTube Transcript to XML Converter

## Application Purpose
Acquires and processes YouTube video transcripts and converts them to structured XML files with chapter organisation and metadata. Acquisition is either input file or YouTube URL (automatic downloads)

## Your Role & Principles
You are the chief architect prioritising:
- **Separation of concerns, DRY principles, YAGNI, elegant simplicity**
- **Test-driven development (TDD)**
- **PRs that deliver incremental value, avoid dead code, include comprehensive tests**

## YOUR IMMEDIATE GOAL
Investigate the codebase and define the next pragmatic PR merging into main. Each PR must:
- Deliver incremental stand-alone value
- Be well-tested with TDD methodology
- Avoid dead code (obsolete refactored out, new integrated into application)
- Prefer smaller sized PRs for incremental value delivery and reduced risk

## Long-term Integration Goal
Merge experimental URL script functionality into main application with clean architecture:

### Target Architecture

```text
models.py (shared data structures)
â”œâ”€â”€ TranscriptDocument (unified container)
â”œâ”€â”€ VideoMetadata (title, date, duration, url)
â”œâ”€â”€ TranscriptLine (timestamp, text)
â””â”€â”€ Chapter (title, times, transcript_lines)

Parsers (produce TranscriptDocument objects)
â”œâ”€â”€ file_parser.py (existing, refactor to use shared models)
â””â”€â”€ url_parser.py (new, extracted from scripts/url_to_transcript.py)*

Presentation
â”œâ”€â”€ xml_builder.py (accepts TranscriptDocument parameter)
â””â”€â”€ cli.py (handles both file and URL workflows)

(*) Important Notes for `url_to_transcript.py`:
- scripts/url_to_transcript.py must be refactored to:
  - Use shared models (removing duplicate data classes)
  - Use xml_builder.py (remove duplicate XML generation logic)
- url_parser.py will be the final integration step (script will be deleted)
```

### Key Requirements
- **Two input methods**: File parser (existing) + URL parser (new)
- **Unified data model**: All parsers return `TranscriptDocument` objects
- **Single XML generator**: Accepts `TranscriptDocument`, eliminates duplication
- **Extended CLI**: Detects input type, routes to appropriate parser

### Current State

Review important project terminology: `docs/terminology.md`

Two methods with same output XML structure:
- File method: `src/file_parser.py` â†’ `xml_builder.py` â†’ XML output
- URL method: `scripts/url_to_transcript.py` (isolated script with duplicate XML logic)

File-based Example (`src/file_parser.py`):

<file_method_example>
(1) Required Input Format e.g. `my_transcript.txt`:
```text
Introduction to Cows
0:02
Welcome to this talk about erm.. er
2:30
Let's start with the fundamentals
Washing the cow
15:45
First, we'll start with the patches
```

(2) Run:
```bash
uv run youtube-to-xml my_transcript.txt
# âœ… Created: my_transcript.xml
```

(3) Output `my_transcript.xml`:
```xml
<?xml version='1.0' encoding='utf-8'?>
<transcript video_title="" video_published="" video_duration="" video_url="">
  <chapters>
    <chapter title="Introduction to Cows" start_time="0:02">
      0:02
      Welcome to this talk about erm.. er
      2:30
      Let's start with the fundamentals</chapter>
    <chapter title="Washing the cow" start_time="15:45">
      15:45
      First, we'll start with the patches</chapter>
  </chapters>
</transcript>
```
</file_method_example>

URL-based Example (`scripts/url_to_transcript.py`):

<url_method_example>
(1) Run:
```bash
uv run url-to-transcript https://youtu.be/Q4gsvJvRjCU
ðŸŽ¬ Processing: https://www.youtube.com/watch?v=Q4gsvJvRjCU
âœ… Created: how-claude-code-hooks-save-me-hours-daily.xml
```

(2) Output `how-claude-code-hooks-save-me-hours-daily.xml` (condensed - 4 chapters, 163 lines total):
```xml
<?xml version='1.0' encoding='utf-8'?>
<transcript video_title="How Claude Code Hooks Save Me HOURS Daily" video_published="2025-07-12" video_duration="2m 43s" video_url="https://www.youtube.com/watch?v=Q4gsvJvRjCU">
  <chapters>
    <chapter title="Intro" start_time="0:00">
      0:00
      Hooks are hands down one of the best
      0:02
      features in Claude Code and for some
      <!-- ... more transcript content ... -->
    </chapter>
    <chapter title="Hooks" start_time="0:19">
      0:20
      To create your first hook, use the hooks
      <!-- ... more transcript content ... -->
    </chapter>
    <!-- ... 3 more chapters ... -->
  </chapters>
</transcript>
```
</url_method_example>

## OUTPUT FOR YOUR IMMEDIATE GOAL

Create a `PRs.md` document in root. Summarising your findings as well as critical challenges that need solving to move toward this new long term architecture. 

Then detail each managable PR that delivers value, ensuring a sequence that eases implementation in steps of value.

Use this structure for  each PR detailed BETWEEEN `<pr_structure>` tags:

<pr_structure>
## Recommended PRs in Logical Order

### PR 1: `branch-prefix/clear-branchname-here`

**PR Contents:**
- [detail contents of PR clearly as a list]

**Value:** [Clealy state value of this PR and confirming no dead code]

**Risk:** [[Size] - [statement about perceived risk]]
**Dependencies:** [stated in terms of previous PRs]
</pr_structure>