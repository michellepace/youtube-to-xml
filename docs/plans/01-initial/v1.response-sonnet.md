# First Deliverable: Core YouTube Transcript to XML Converter

## 1. First Deliverable Scope

**Smallest Working Piece:** Complete transcript processing pipeline

- Read transcript file → detect chapters → extract content → generate valid XML
- CLI interface with `youtube-to-xml transcript.txt`
- Output XML file to `transcript_files/` directory
- Basic error handling for file not found and invalid format

**Why This Scope:** Demonstrates the entire core functionality end-to-end while remaining focused and testable.

## 2. Architecture: Module Design (One Purpose Each)

Following "one module, one purpose" principle:

```text
src/youtube_to_xml/
├── parsing.py           # File I/O and basic text operations
├── detection.py         # Chapter detection (extend transcript_reporter.py)
├── content_extraction.py # Extract content lines for each chapter
├── xml_generation.py    # Generate XML using ElementTree API
└── main.py             # CLI interface and orchestration
```

**Key Design Decisions:**

- Extend existing `Chapter` dataclass to include `content_lines: list[str]`
- Reuse proven `TIMESTAMP_PATTERN` and detection logic from `scripts/transcript_reporter.py`
- Pure functions for business logic (easy to test)
- Error handling at CLI boundary only

## 3. TDD Implementation Plan

**Test-First Development Order:**

1. `test_parsing.py` → `parsing.py` (file reading, basic validation)
2. `test_detection.py` → `detection.py` (chapter detection rules)  
3. `test_content_extraction.py` → `content_extraction.py` (extract lines per chapter)
4. `test_xml_generation.py` → `xml_generation.py` (ElementTree XML building)
5. `test_main.py` → `main.py` (CLI integration, error handling)

**Testing Strategy:**

- Use `tmp_path` fixture for file operations
- No mocks - test with real data
- Test incremental behaviors, one test per feature

## 4. Manual Verification Commands

Beyond `uv run python -m pytest`:

```bash
# Test core functionality
uv run youtube-to-xml transcript_files/learn-nextjs-7mins.txt

# Verify XML output
cat transcript_files/learn-nextjs-7mins.xml | head -20

# Validate XML parsing
uv run python -c "import xml.etree.ElementTree as ET; ET.parse('transcript_files/learn-nextjs-7mins.xml')"

# Test error handling  
uv run youtube-to-xml nonexistent.txt
uv run youtube-to-xml --help

# Code quality
uv run ruff check
uv run ruff format --check
```

## 5. Success Criteria

- [ ] CLI processes sample transcript without errors
- [ ] XML output matches SPEC.md template exactly  
- [ ] XML parses successfully with ElementTree
- [ ] All tests pass with good coverage
- [ ] Error messages match SPEC.md format
- [ ] Code passes ruff linting

**Estimated Development:** 4-6 hours with TDD approach
